var imagePath=base_url+"assets/images/";var personId="";var personHasAlreadyChosen=false;var gameId="";var correctAccessCode="";var chosenPerson;function ucFirst(a){return a.charAt(0).toUpperCase()+a.slice(1)}function updateImage(b,a){a.attr("src",b)}function verifyCodeListener(a){a.keyup(function(){var b=$(this).val();if(b.length===4){$.ajax({type:"POST",url:site_url+"/game/ajaxVerifyAccessCode",data:{accessCode:b},dataType:"json",success:function(c){if(c.userId>0){window.location.href=site_url+"game/home"}},error:function(e,c,d){console.log("-- ERROR IN AJAX --\n\n"+e.responseText)}})}})}function showPossiblePersons(c,d,b,a){$.ajax({type:"POST",url:site_url+"/game/ajaxGetRandomPerson",data:{currentPersonId:c,gameId:d},dataType:"json",success:function(f){var k=f.allPersonsImageNames;var h=k.length;chosenPerson=f.randomPerson;var j;var g=0;var e=0;var l=0;for(j=0;j<16;j++){setTimeout(function(){e=Math.floor(Math.random()*(h-1));while(e===l){e=Math.floor(Math.random()*(h-1))}l=e;updateImage(imagePath+k[e]+".jpg",b)},g);g+=250}setTimeout(function(){updateImage(imagePath+chosenPerson.image+".jpg",b);var i="";if(chosenPerson.nickname===chosenPerson.name){i="You picked "+ucFirst(chosenPerson.name)+" "+ucFirst(chosenPerson.lastname)+"!"}else{i='You picked "'+ucFirst(chosenPerson.nickname)+'" aka '+ucFirst(chosenPerson.name)+" "+ucFirst(chosenPerson.lastname)+"!"}var m="";if(chosenPerson.isMale){m="You can surprise him with a gift of € 20."}else{m="You can surprise her with a gift of € 20."}a.find("p.result").html(i);a.find("p.result-ps").html(m)},4000)},error:function(g,e,f){console.log("-- ERROR IN AJAX --\n\n"+g.responseText)}})}function startButtonListener(b,d,a,c){b.click(function(){personId=$("#person-id").val();gameId=$("#game-id").val();a.find("p.result").html("Randomizing ... now");showPossiblePersons(personId,gameId,c,a)})}$(document).ready(function(){var a=$("input#accessCode");var d=$("img.img-chosen-person");var c=$("button#start-game");var e=$("div.controls-wrapper");var b=$("div.result-wrapper");verifyCodeListener(a);startButtonListener(c,e,b,d)});