var imagePath=base_url+"assets/images/";var personId="";var personHasAlreadyChosen=false;var gameId="";var gameBudget="0";var correctAccessCode="";var chosenPerson;function ucFirst(a){return a.charAt(0).toUpperCase()+a.slice(1)}function updateImage(b,a){a.attr("src",b)}function verifyCodeListener(a){a.keyup(function(){var b=$(this).val();if(b.length===4){$.ajax({type:"POST",url:site_url+"/game/ajaxVerifyAccessCode",data:{accessCode:b},dataType:"json",success:function(c){if(c.userId>0){window.location.href=site_url+"game/home"}},error:function(e,c,d){console.log("-- ERROR IN AJAX --\n\n"+e.responseText)}})}})}function showPossiblePersons(c,d,e,b,a){$.ajax({type:"POST",url:site_url+"/game/ajaxGetRandomPerson",data:{currentPersonId:c,gameId:d},dataType:"json",success:function(g){var l=g.allPersonsImageNames;var j=l.length;chosenPerson=g.randomPerson;var k;var h=0;var f=0;var m=0;for(k=0;k<16;k++){setTimeout(function(){f=Math.floor(Math.random()*(j-1));while(f===m){f=Math.floor(Math.random()*(j-1))}m=f;updateImage(imagePath+l[f]+".jpg",b)},h);h+=250}setTimeout(function(){updateImage(imagePath+chosenPerson.image+".jpg",b);var i="";if(chosenPerson.nickname===chosenPerson.name){i="You picked "+ucFirst(chosenPerson.name)+" "+ucFirst(chosenPerson.lastname)+"!"}else{i="You picked "+ucFirst(chosenPerson.name)+" "+ucFirst(chosenPerson.lastname)+' aka "'+ucFirst(chosenPerson.nickname)+'"!'}var n="";if(parseInt(chosenPerson.isMale)===1){n="You can surprise him with a gift of €"+e}else{n="You can surprise her with a gift of €"+e}a.find("p.result").html(i);a.find("p.result-ps").html(n)},4000);$("#start-game").hide()},error:function(h,f,g){console.log("-- ERROR IN AJAX --\n\n"+h.responseText)}})}function startButtonListener(b,d,a,c){b.click(function(){personId=$("#person-id").val();gameId=$("#game-id").val();gameBudget=$("#game-budget").val();a.find("p.result").html("Randomizing ... now");showPossiblePersons(personId,gameId,gameBudget,c,a)})}$(document).ready(function(){var a=$("input#accessCode");var d=$("img.img-chosen-person");var c=$("button#start-game");var e=$("div.controls-wrapper");var b=$("div.result-wrapper");verifyCodeListener(a);startButtonListener(c,e,b,d)});